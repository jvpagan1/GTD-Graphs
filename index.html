---
title: "GTD Graphs Notebook"
output:
  html_document:
    df_print: paged
---


Read 2016 GTD database from Excel file download.
```{r message=FALSE, warning=FALSE}
library(readxl)
gtd <- read_excel("C:/Users/jvpag/R-repository/GTD/globalterrorismdb_0617dist.xlsx")


```

Table With Number of Terrorist Incidents by Year for Top 10 Countries.
```{r}
w<-table(gtd[,2]) #total world incidents by year
x<-table(gtd[,9]) # total number of incidents by country
x<-sort(x) # list of countries in ascending order by total number of incidents by country
top10<-rownames(tail(x,10)) # top 10 countries by number of terrorist incidents
t<-table(gtd[gtd$country_txt %in% top10,c(9,2)])
t
```

Table With Number of Terrorist Incidents by Year for the World.
```{r}
w

```

Exponential Plot for Number of Incidents by Year for Irak and the World.
```{r}
colors <- c("blue","red","forestgreen","yellow")
plot(colnames(t),t["Iraq",], log="y", type="l", col=colors[1], 
      ylim=c(1, 40000),
      xaxt="n",
      main = "Historical annual number of terrorist attacks in Iraq",
      xlab="Year", ylab="Number of Terrorist Attacks")
lines(rownames(w),w, type="l", col=colors[2])#, pchl
legend("bottomright", # places a legend at the appropriate place c(“Health”,”Defense”), # puts text in the legend
legend=c("World","Iraq"),
  lty=c(1,1), # gives the legend appropriate symbols (lines)
  lwd=c(2.5,2.5),col=colors[2:1]) # gives the legend lines the correct color and width
grid(lty=2)
x_axis = rownames(w)
x_axis = x_axis[1:length(x_axis) %% 2 == 0]
axis(1,x_axis, las=2, cex.axis=.8)
```

Logarithmic Plot for Terrorist Attacks by Year for Top 10 Countries and the World.
```{r message=FALSE, warning=FALSE}
top<-rownames(tail(x,10)) # top 10 countries by number of terrorist incidents
t<-table(gtd[gtd$country_txt %in% top,c(9,2)])
colors <- rainbow(nrow(t))
countries = rownames(t)
plot(colnames(t),t["Iraq",], log="y", type="n", col="black",
     ylim=c(1, 40000), 
     main = "Terrorist attacks by year for top 10 countries\n(logarithmic graph)",
     xlab="Year", ylab="Number of Terrorist Attacks", xaxt="n")
lines(rownames(w), w, type="l", col="black")#, pchl
for(i in 1:length(countries)){
 lines(colnames(t),t[i,], type="l", col=colors[i])#, pchl
}


legend("topleft", # places a legend at the appropriate place c(“Health”,”Defense”), # puts text in the legend
  legend=c("World",countries),
  lty=c(1,1), # gives the legend appropriate symbols (lines)
  lwd=c(2.5,2.5),col=c("black",colors), cex=.7, ncol=4) # gives the legend lines the correct color and width
grid(lty=2)
axis(1,x_axis, las=2, cex.axis=.8)
```

Plot Number of Incidents by Year for Top 10 Countries.
```{r}
top<-rownames(tail(x,10)) # top 10 countries by number of terrorist incidents
t<-table(gtd[gtd$country_txt %in% top,c(9,2)])
colors <- rainbow(nrow(t))
countries = rownames(t)
plot(colnames(t),t["Iraq",], type="n", col=colors[1],ylim=c(1, 4000),
     xaxt="n",
     main = "Terrorist attacks by year for top 10 countries",
     xlab="Year", ylab="Number of Terrorist Attacks")
for(i in 1:length(countries)){
  lines(colnames(t),t[i,], type="l", col=colors[i])#, pchl
}


legend("topleft", # places a legend at the appropriate place c(“Health”,”Defense”), # puts text in the legend
legend=countries,
lty=c(1,1), # gives the legend appropriate symbols (lines)
lwd=c(2.5,2.5),col=colors, cex=.8, ncol=1) # gives the legend lines the correct color and width
grid(lty=2)
axis(1,x_axis, las=2, cex.axis=.8)
```

Individual Plots of Number of Incidents by Year for Top 10 Countries.
```{r}
ncountries=10
top<-rownames(tail(x,ncountries)) # top 10 countries by number of terrorist incidents
t<-table(gtd[gtd$country_txt %in% top,c(9,2)])
t<-t[order(rank(rowSums(t))),]
colors <- rainbow(nrow(t))
countries = rownames(t)
#par(pch=22, col="red") # plotting symbol and color 
par(mfrow=c(ncountries/5,5)) # all plots on one page 
for(i in 1:length(countries)){
  plot(colnames(t),t[i,], type="l", col=colors[i],
       ylim=c(1, max(t[,])), 
       xaxt="n",
       xlab="Year", ylab="Number of Terrorist Attacks",main=countries[i])
grid(lty=2)
x_axis = rownames(w)
x_axis = x_axis[1:length(x_axis) %% 9 == 0]
axis(1,x_axis, las=2, cex.axis=.77)
}
```